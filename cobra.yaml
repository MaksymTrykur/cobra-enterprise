namespace: cobra

db:
  defines: runnable
  inherits: mongodb/mongodb

enterprise:
  defines: runnable
  metadata:
    name: Cobra Enterprise
    description: "Cobra Enterprise, now with highscores :)"
  containers:
    app:
      image: "docker.io/nooga/cobra-enterprise:latest"
      environment:
        - <- `DB_HOST=` connection-hostname("mongo") concat
        - <- `DB_PORT=` connection-port("mongo") concat
  services:
    app:
      container: app
      protocol: tcp
      port: 3001
      host-port: 3001
  connections:
    mongo:
      runnable: cobra/db
      service: mongodb
  variables:
    db-name:
      type: string
      value: mongo
      env: DB_NAME
    db-user:
      type: string
      value: mongo
      env: DB_USER
    db-pass:
      type: string
      value: password
      anv: DB_PASS

system:
  defines: process-group
  runnable-list:
    - cobra/db
    - cobra/enterprise
